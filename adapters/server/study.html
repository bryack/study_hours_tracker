<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Study Hours Tracker</title>
</head>
<body>
<h1>Study Hours Tracker</h1>

<section id="study">
<div id="manual-section">
        <h2>Record Manual Hours</h2>
        <label for="manual-subject">Subject:</label>
        <input type="text" id="manual-subject" placeholder="e.g., math, physics"/>
        <label for="manual-hours">Hours:</label>
        <input type="number" id="manual-hours" min="1" placeholder="e.g., 2"/>
        <button id="record-manual">Record Hours</button>
    </div>

    <div id="pomodoro-section">
        <h2>Start Pomodoro Session</h2>
        <label for="pomodoro-subject">Subject:</label>
        <input type="text" id="pomodoro-subject" placeholder="e.g., math, physics"/>
        <button id="start-pomodoro">Start Pomodoro (25 min)</button>
    </div>
    
    <div id="alerts"></div>
</section>

</body>
<script type="application/javascript">
    const startPomodoroButton = document.getElementById('start-pomodoro')
    const pomodoroSubjectInput = document.getElementById('pomodoro-subject')
    const recordManualButton = document.getElementById('record-manual')
    const manualSubjectInput = document.getElementById('manual-subject')
    const manualHoursInput = document.getElementById('manual-hours')
    const alertsContainer = document.getElementById('alerts')
    
    if (window['WebSocket']) {
        const conn = new WebSocket('ws://' + document.location.host + '/ws')
        
        startPomodoroButton.onclick = event => {
            const subject = pomodoroSubjectInput.value.trim()
            if (!subject) {
                alert('Please enter a subject')
                return
            }
            
            conn.send(JSON.stringify({
                command: "start_pomodoro",
                subject: subject
            }))
            
            alertsContainer.innerHTML = '<p><strong>Starting Pomodoro for ' + subject + '...</strong></p>'
        }
        
        recordManualButton.onclick = event => {
            const subject = manualSubjectInput.value.trim()
            const hours = parseInt(manualHoursInput.value)
            
            if (!subject || !hours || hours < 1) {
                alert('Please enter both subject and valid hours')
                return
            }
            
            conn.send(JSON.stringify({
                command: "record_manual",
                subject: subject,
                hours: hours
            }))
        }
        
        conn.onmessage = evt => {
            alertsContainer.innerHTML += '<p>' + evt.data + '</p>'
        }
        
        conn.onerror = evt => {
            alertsContainer.innerHTML += '<p style="color: red;">Connection error</p>'
        }
        
        conn.onclose = evt => {
            alertsContainer.innerHTML += '<p style="color: gray;">Connection closed</p>'
        }
    } else {
        alertsContainer.innerHTML = '<p style="color: red;">WebSocket not supported by your browser</p>'
    }
</script>
</html>
